#program to compare an estimated fitted line from real data with a line of any #given slope (e.g. to compare if a correlation is different from a line with slope 1)##after Scherrer (1984) p. 651#x vector of the independent variable#y vector of dependent variable#B slope against which we would like to test, usually = 0#source("~/Desktop/programs/slope.test.R")slope.test <- function(x, y, B){ #deals with NA: makes temporary dataframe without NA, then  #hands back the vectors to x and yd <- na.omit(data.frame(cbind(x,y)))x <- d$xy <- d$ymodel <- lm(y~x)s <- summary(lm(y~x))#gives variance of slope b# var <- [(SS residuals/Df residuals) / (SS x^2 - (SS x)^2)/ n x) ]^0.5var <- ((sum(s$residuals^2)/model$df.residual) / (sum(x^2)-(sum(x))^2/length(x)))^0.5#gives t value to be tested#actual slope b - slope to be testet B / variance of bt <- (s$coefficients[2] - B)/var#probability of that t-valuept <- 2*(1- pt(abs(t),model$df.residual))print("t-value")print(abs(t))print("p-value:")print(pt)print("df:")df <- model$df.residualprint(df)}